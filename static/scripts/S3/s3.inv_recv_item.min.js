$(document).ready(function(){var t=$("#inv_track_item_item_id");if(t.length){var E,B=S3.supply.packs||{},n,a,g=S3.supply.binnedQuantity||0,y,K=$("#rdy-defaultbin-0"),e,C,u=$("#sub-defaultrecv_bin"),p=t.val(),v=$("#inv_track_item_item_pack_id"),z,f,w=$("#sub_defaultrecv_bin_defaultrecv_bin_i_quantity_edit_none"),L=/(\d)(?=(\d{3})+(?!\d))/g,h=$("#sub_defaultrecv_bin_defaultrecv_bin_i_quantity_edit_0"),k,F,l,A,D,G,d,q=$("#inv_track_item_quantity"),m=$("#inv_track_item_recv_quantity"),b,H=$("#inv_track_item_req_item_id__row"),
c,I;H.length&&H.hide();var J=function(){C=!0;A=B[p];D={};G=A.length;v.html("");for(i=0;i<G;i++)l=A[i],D[l.i]=l.q,C?(z=l.i,k=d=l.q,selected=" selected"):selected="",C=!1,F='<option value="'+l.i+'"'+selected+">"+l.n+"</option>",v.append(F)};t.on("change.s3",function(r,x){p=t.val();x||(q.val(""),m.val(""),c=b=0,u.inlinecomponent("removeRows"),g=0);(A=B[p])?J():(E=S3.Ap.concat("/supply/item_packs.json/"+p),$.ajaxS3({url:E,dataType:"json",success:function(M){B[p]=M;J()}}))});p&&(startingItemPackID=z=v.val(),
t.trigger("change.s3",!0));v.on("change.s3",function(){z=v.val();d=D[z];if(c=q.val())c=parseFloat(c),c=c*k/d,q.val(totalQuantity),(b=m.val())?(b=parseFloat(b),b=b*k/d,m.val(b)):b=c;a=w.val();a=a*k/d;w.val(a);a=h.val();a=a*k/d;h.val(a);I=function(r){a=r.quantity.value;a=a*k/d;r.quantity.value=a;r.quantity.text=a.toString().replace(L,"$1,")};u.inlinecomponent("updateRows",I);k=d});u.on("click.s3",".inline-edt",function(){if(a=h.val())a=parseFloat(a),g-=a*d});K.click(function(){if(a=h.val())a=parseFloat(a),
g+=a*d});q.change(function(){(c=q.val())?(c=parseFloat(c),(b=m.val())?b>c&&(f="Quantity Sent increased to Quantity Received",e=$('<div class="alert alert-warning" style="padding-left:36px;">'+f+'<button type="button" class="close" data-dismiss="alert">\u00d7</button></div>'),q.val(b).parent().append(e).undelegate(".s3").delegate(".alert","click.s3",function(){$(this).fadeOut("slow").remove();return!1})):b=c):c=b=0});m.change(function(){(b=m.val())?(b=parseFloat(b),b>c&&(f="Quantity Received reduced to Quantity Sent",
e=$('<div class="alert alert-warning" style="padding-left:36px;">'+f+'<button type="button" class="close" data-dismiss="alert">\u00d7</button></div>'),m.val(c).parent().append(e).undelegate(".s3").delegate(".alert","click.s3",function(){$(this).fadeOut("slow").remove();return!1}))):b=c});w.change(function(){if(a=w.val())a=parseFloat(a),y=1*g/d,n=b-y,a>n&&(f="Bin Quantity reduced to Quantity remaining to be Received",e=$('<div class="alert alert-warning" style="padding-left:36px;">'+f+'<button type="button" class="close" data-dismiss="alert">\u00d7</button></div>'),
w.val(n).parent().append(e).undelegate(".s3").delegate(".alert","click.s3",function(){$(this).fadeOut("slow").remove();return!1}))});h.change(function(){if(a=h.val())a=parseFloat(a),y=1*g/d,n=b-y,a>n&&(f="Bin Quantity reduced to Quantity remaining to be Received",e=$('<div id="sub_defaultrecv_bin_defaultrecv_bin_i_quantity_edit_0-warning" class="alert alert-warning" style="padding-left:36px;">'+f+'<button type="button" class="close" data-dismiss="alert">\u00d7</button></div>'),h.val(n).parent().append(e).undelegate(".s3").delegate(".alert",
"click.s3",function(){$(this).fadeOut("slow").remove();return!1}))});u.on("rowAdded",function(r,x){if(a=x.quantity.value)a=parseFloat(a),g+=a*d});u.on("rowRemoved",function(r,x){if(a=x.quantity.value)a=parseFloat(a),g-=a*d})}});
