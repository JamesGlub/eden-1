$(document).ready(function(){var k=$("#inv_inv_item_item_id");if(k.length){var d,x={},e,a,c=S3.supply.binnedQuantity||0,D=$("#rdy-defaultbin-0"),f,q=$("#sub-defaultbin"),g=k.val(),l=$("#inv_inv_item_item_pack_id"),A=S3.supply.itemPackID,m=$("#sub_defaultbin_defaultbin_i_quantity_edit_none"),n=$("#sub_defaultbin_defaultbin_i_quantity_edit_0"),y,r,B,t=$("#inv_inv_item_site_id"),u=$("#inv_inv_item_quantity"),b=u.val(),v;if(t.length){var E=$('a[id^="inv"].s3_add_resource_link'),F=/%5Bid%5D/g,z=t.val(),
p,G=$('div[id^="sub_defaultbin_defaultbin_i_layout_id"].s3-hierarchy-widget');t.change(function(){q.inlinecomponent("removeRows");p=t.val();d=S3.Ap.concat("/org/site/"+p+"/layout/hierarchy.tree");G.hierarchicalopts("reload",d);E.each(function(){v=$(this);d=z?v.attr("href").replace(z,p):v.attr("href").replace(F,p);v.attr("href",d)});z=p})}b=b?parseFloat(b):0;var C=function(w){r=x[g];B=r.length;l.html("");for(i=0;i<B;i++)y=r[i],opt='<option value="'+y.i+'">'+y.n+"</option>",l.append(opt);w&&(l.val(A),
S3ClearNavigateAwayConfirm())};k.on("change.s3",function(w,h){g=k.val();(r=x[g])?C(h):(d=S3.Ap.concat("/supply/item_packs.json/"+g),$.ajaxS3({url:d,dataType:"json",success:function(H){x[g]=H;C(h)}}))});g&&k.trigger("change.s3",!0);l.on("change.s3",function(){A=l.val()});q.on("click.s3",".inline-edt",function(){a=(a=n.val())?parseFloat(a):0;c-=a});D.click(function(){a=(a=n.val())?parseFloat(a):0;c+=a;m.change()});u.change(function(){b=(b=u.val())?parseFloat(b):0;b<c&&(message="Total Quantity reduced to Quantity in Bins",
f=$('<div class="alert alert-warning" style="padding-left:36px;">'+message+'<button type="button" class="close" data-dismiss="alert">\u00d7</button></div>'),u.val(c).parent().append(f).undelegate(".s3").delegate(".alert","click.s3",function(){$(this).fadeOut("slow").remove();return!1}));m.change()});m.change(function(){a=(a=m.val())?parseFloat(a):0;e=b-c;a>e&&(message="Bin Quantity reduced to Available Quantity",f=$('<div class="alert alert-warning" style="padding-left:36px;">'+message+'<button type="button" class="close" data-dismiss="alert">\u00d7</button></div>'),
m.val(e).parent().append(f).undelegate(".s3").delegate(".alert","click.s3",function(){$(this).fadeOut("slow").remove();return!1}))});n.change(function(){a=(a=n.val())?parseFloat(a):0;e=b-c;a>e&&(message="Bin Quantity reduced to Available Quantity",f=$('<div class="alert alert-warning" style="padding-left:36px;">'+message+'<button type="button" class="close" data-dismiss="alert">\u00d7</button></div>'),n.val(e).parent().append(f).undelegate(".s3").delegate(".alert","click.s3",function(){$(this).fadeOut("slow").remove();
return!1}))});q.on("rowAdded",function(w,h){c+=parseFloat(h.quantity.value)});q.on("rowRemoved",function(w,h){c-=parseFloat(h.quantity.value)})}});
