var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(a,d,c){a instanceof String&&(a=String(a));for(var f=a.length,e=0;e<f;e++){var b=a[e];if(d.call(c,b,e,a))return{i:e,v:b}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;$jscomp.FORCE_POLYFILL_PROMISE=!1;$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,d,c){if(a==Array.prototype||a==Object.prototype)return a;a[d]=c.value;return a};$jscomp.getGlobal=function(a){a=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var d=0;d<a.length;++d){var c=a[d];if(c&&c.Math==Math)return c}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(a,d){var c=$jscomp.propertyToPolyfillSymbol[d];if(null==c)return a[d];c=a[c];return void 0!==c?c:a[d]};
$jscomp.polyfill=function(a,d,c,f){d&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(a,d,c,f):$jscomp.polyfillUnisolated(a,d,c,f))};$jscomp.polyfillUnisolated=function(a,d,c,f){c=$jscomp.global;a=a.split(".");for(f=0;f<a.length-1;f++){var e=a[f];if(!(e in c))return;c=c[e]}a=a[a.length-1];f=c[a];d=d(f);d!=f&&null!=d&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:d})};
$jscomp.polyfillIsolated=function(a,d,c,f){var e=a.split(".");a=1===e.length;f=e[0];f=!a&&f in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var b=0;b<e.length-1;b++){var p=e[b];if(!(p in f))return;f=f[p]}e=e[e.length-1];c=$jscomp.IS_SYMBOL_NATIVE&&"es6"===c?f[e]:null;d=d(c);null!=d&&(a?$jscomp.defineProperty($jscomp.polyfills,e,{configurable:!0,writable:!0,value:d}):d!==c&&(void 0===$jscomp.propertyToPolyfillSymbol[e]&&(c=1E9*Math.random()>>>0,$jscomp.propertyToPolyfillSymbol[e]=$jscomp.IS_SYMBOL_NATIVE?
$jscomp.global.Symbol(e):$jscomp.POLYFILL_PREFIX+c+"$"+e),$jscomp.defineProperty(f,$jscomp.propertyToPolyfillSymbol[e],{configurable:!0,writable:!0,value:d})))};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(d,c){return $jscomp.findInternal(this,d,c).v}},"es6","es3");
$(document).ready(function(){var a=$("#inv_track_item_send_inv_item_id");if(a.length){var d=S3.supply.inv_items,c,f,e,b,p=S3.supply.binnedQuantity||0,D,W=$("#inv_track_item_sub_defaultsend_bin__row"),E,B,L,R,t,ka=$("#rdy-defaultbin-0"),u,da=$("#quantity__error"),g,I=$("#sub-defaultsend_bin"),X,r,S=$("#inv_track_item_item_pack_id"),T,la=$("#sub_defaultsend_bin_defaultsend_bin_i_layout_id_edit_none"),v=$("#sub_defaultsend_bin_defaultsend_bin_i_quantity_edit_none"),F=$("#sub_defaultsend_bin_defaultsend_bin_i_layout_id_edit_none-hierarchy"),
ea=/(\d)(?=(\d{3})+(?!\d))/g,ma=$("#sub_defaultsend_bin_defaultsend_bin_i_layout_id_edit_0"),y=$("#sub_defaultsend_bin_defaultsend_bin_i_quantity_edit_0"),G,fa,k,h,M,N,U,ha,q=$("#inv_track_item_quantity"),Y=$("#inv_track_item_req_item_id__row"),z,O,na=S3.supply.site_id,J=a.val(),A,ia=S3.supply.itemPackID,Z=1,n,oa=$('div[id^="sub_defaultsend_bin_defaultsend_bin_i_layout_id"].s3-hierarchy-widget'),V,aa;Y.length&&Y.hide();var ca=function(){ba?(V=function(m){m.quantity.value=l;m.quantity.text=l.toString().replace(ea,
"$1,")},I.inlinecomponent("updateRows",V),$("#edt-defaultsend_bin-0").hide(),$("#rmv-defaultsend_bin-0").hide()):(W.show(),E=L[0].q,E*r>l*h?v.val(l):v.val(E*r/h))};a.on("change.s3",function(m,C){var K=a.val();S.html("");C||(ba=!1,q.val(""),l=0,I.inlinecomponent("removeRows"),p=0);$("#TotalQuantity").remove();m=d[K];X=m.q;N=m.p;U=N.length;z=m.r;for(g=0;g<U;g++)if(k=N[g],1==k.q){ha=k.n;break}for(g=0;g<U;g++){k=N[g];if(void 0!=k.d){var ja=!0;r=k.q}else ja=!1;ia&&J==K&&ia==k.i?(T=k.i,G=Z=h=k.q,M=k.n,
O=" selected"):ja?(T=k.i,G=h=k.q,M=k.n,O=" selected"):O="";fa=1!==k.q?'<option value="'+k.i+'"'+O+">"+k.n+" ("+k.q+" x "+ha+")</option>":'<option value="'+k.i+'"'+O+">"+k.n+"</option>";S.append(fa)}C&&(p=p*r/h);L=m.b;t=L.length;if(0==t)W.hide();else if(1==t)if(ba)$("#add-row-defaultsend_bin").hide(),$("#read-row-defaultsend_bin-0 > .subform-action").hide();else{ca();var P=function(){F.hierarchicalopts("set",[L[0].l]);v.attr("disabled","disabled");$("#add-row-defaultsend_bin > .subform-action").hide();
F.next(".s3_inline_add_resource_link").hide();$(".s3-hierarchy-button").attr("disabled","disabled")};if(F.is(":data('s3-hierarchicalopts')"))P();else F.find(".s3-hierarchy-tree").first().on("ready.jstree",function(){P()})}else{R={};for(g=0;g<t;g++)e=L[g],R[e.l]=e.q;W.show();P=function(){v.removeAttr("disabled");$("#add-row-defaultsend_bin > .subform-action").show();F.next(".s3_inline_add_resource_link").show();$(".s3-hierarchy-button").removeAttr("disabled");c=S3.Ap.concat("/org/site/"+na+"/layout/hierarchy.tree?inv_item_id="+
K);oa.hierarchicalopts("reload",c)};if(F.is(":data('s3-hierarchicalopts')"))P();else F.find(".s3-hierarchy-tree").first().on("ready.jstree",function(){P()})}if(da.length)for(m=da.html().split(" "),g=0;g<m.length&&!(n=parseFloat(m[g]));g++);else n=X*r/h,A&&J==K&&(n+=A*Z/h);m='<span id="TotalQuantity"> / '+n.toFixed(2)+" "+M+" ("+i18n.in_inv+")</span>";q.after(m);if(z){var w=z[0];aa=function(){if(1==z.length){if(!A||J!=K){var x=w.q/h;l=x<=n?x:n;q.val(l);1==t&&ca()}$("#inv_track_item_req_item_id").val(w.i)}else{Y.show();
var Q=$("#inv_track_item_req_item_id"),H=Q.val();H&&(H=parseInt(H));Q.html("");for(g=0;g<z.length;g++)w=z[g],Q.append(new Option(w.r,w.i)),H?w.i!=H||A&&J==K||(x=w.q/h,x<=n?q.val(x):q.val(n)):C&&(x=w.q/h,x<=n?q.val(x):q.val(n)),C=!1;Q.on("change",function(){H=parseInt(Q.val());for(g=0;g<z.length;g++)if(w=z[g],w.i==H){x=w.q/h;x<=n?q.val(x):q.val(n);break}})}};aa()}});S.on("change.s3",function(){T=parseInt(S.val());for(g=0;g<U;g++)if(k=N[g],k.i==T){h=k.q;M=k.n;n=X*r/h;A&&J==inv_item_id&&(n+=A*Z/h);$("#TotalQuantity").html(n.toFixed(2)+
" "+M+" ("+i18n.in_inv+")");l=q.val();l=l*G/h;q.val(l);b=v.val();b=b*G/h;v.val(b);b=y.val();b=b*G/h;y.val(b);V=function(m){b=m.quantity.value;b=b*G/h;m.quantity.value=b;m.quantity.text=b.toString().replace(ea,"$1,")};I.inlinecomponent("updateRows",V);G=h;z&&aa();break}});if(J){var ba=!0;0==p&&(p=(p=y.val())?parseFloat(p):0);var l=(A=q.val())?A=parseFloat(A):0;a.trigger("change.s3",!0)}q.change(function(){(l=q.val())?(l=parseFloat(l),$("#inv_track_item_quantity-error").remove()):l=0;l>n&&(message=
"Total Quantity reduced to Quantity in Stock",u=$('<div id="inv_track_item_quantity-warning" class="alert alert-warning" style="padding-left:36px;">'+message+'<button type="button" class="close" data-dismiss="alert">\u00d7</button></div>'),q.val(n).parent().append(u).undelegate(".s3").delegate(".alert","click.s3",function(){$(this).fadeOut("slow").remove();return!1}),l=n);1==t?ca():1<t&&(D=p*r/h,l<D&&(message="Total Quantity increased to Quantity in Bins",u=$('<div id="inv_track_item_quantity-warning" class="alert alert-warning" style="padding-left:36px;">'+
message+'<button type="button" class="close" data-dismiss="alert">\u00d7</button></div>'),q.val(D).parent().append(u).undelegate(".s3").delegate(".alert","click.s3",function(){$(this).fadeOut("slow").remove();return!1})),v.change())});v.change(function(){if(1<t&&(b=v.val())){b=parseFloat(b);if(e=la.val())E=R[e],B=E*r/h,b>B&&(message="Bin Quantity reduced to Quantity of Stock in Bin",u=$('<div id="sub_defaultsend_bin_defaultsend_bin_i_quantity_edit_none-warning" class="alert alert-warning" style="padding-left:36px;">'+
message+'<button type="button" class="close" data-dismiss="alert">\u00d7</button></div>'),v.val(B).parent().append(u).undelegate(".s3").delegate(".alert","click.s3",function(){$(this).fadeOut("slow").remove();return!1}),b=B);D=p*r/h;f=l-D;b>f&&(message="Bin Quantity reduced to Quantity remaining to be Sent",u=$('<div id="sub_defaultsend_bin_defaultsend_bin_i_quantity_edit_none-warning" class="alert alert-warning" style="padding-left:36px;">'+message+'<button type="button" class="close" data-dismiss="alert">\u00d7</button></div>'),
v.val(f).parent().append(u).undelegate(".s3").delegate(".alert","click.s3",function(){$(this).fadeOut("slow").remove();return!1}))}});y.change(function(){if(1<t&&(b=y.val())){b=parseFloat(b);if(e=ma.val())E=R[e],B=E*r/h,b>B&&(message="Bin Quantity reduced to Quantity of Stock in Bin",u=$('<div id="sub_defaultsend_bin_defaultsend_bin_i_quantity_edit_0-warning" class="alert alert-warning" style="padding-left:36px;">'+message+'<button type="button" class="close" data-dismiss="alert">\u00d7</button></div>'),
y.val(B).parent().append(u).undelegate(".s3").delegate(".alert","click.s3",function(){$(this).fadeOut("slow").remove();return!1}),b=B);D=p*r/h;f=l-D;b>f&&(message="Bin Quantity reduced to Quantity remaining to be Sent",u=$('<div id="sub_defaultsend_bin_defaultsend_bin_i_quantity_edit_0-warning" class="alert alert-warning" style="padding-left:36px;">'+message+'<button type="button" class="close" data-dismiss="alert">\u00d7</button></div>'),y.val(f).parent().append(u).undelegate(".s3").delegate(".alert",
"click.s3",function(){$(this).fadeOut("slow").remove();return!1}))}});I.on("click.s3",".inline-edt",function(){1<t&&(b=y.val())&&(b=parseFloat(b),p-=b*h/r)});ka.click(function(){if(1<t){if(b=y.val())b=parseFloat(b),p+=b*h/r;v.change()}});I.on("rowAdded",function(m,C){if(1<t){if(b=C.quantity.value)b=parseFloat(b),p+=b*h/r;$("#sub_defaultsend_bin_defaultsend_bin_i_quantity_edit_none-warning").remove()}});I.on("rowRemoved",function(m,C){1<t&&(b=C.quantity.value)&&(b=parseFloat(b),p-=b*h/r)})}});
