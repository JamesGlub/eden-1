$(document).ready(function(){var r=$("#inv_track_item_send_inv_item_id");if(r.length){var y=$("#inv_track_item_req_item_id__row");y.length&&y.hide();var K=function(){var z=r.val(),k=$("#inv_track_item_item_pack_id"),l=$("#inv_track_item_quantity");k.html("");$("#TotalQuantity").remove();if(""!==z){var f=$(this).attr("id");try{S3.JSONRequest[f].abort()}catch(a){}var F=S3.supply.inv_items;if(void 0===F){0===$("#item_pack_throbber").length&&k.after('<div id="item_pack-throbber" class="throbber"/>');
var q=S3.Ap.concat("/inv/inv_item_quantity.json/"+z);S3.JSONRequest[f]=$.getJSON(q,function(a){var c,m=a.quantity,t=a.packs,u=t.length;a=!0;for(c=0;c<u;c++){var d=t[c];if(1==d.quantity){var A=d.name;break}}for(c=0;c<u;c++){d=t[c];if(a){var B=d.quantity;var C=d.name;a=" selected"}else a="";a=1!==d.quantity?'<option value="'+d.id+'"'+a+">"+d.name+" ("+d.quantity+" x "+A+")</option>":'<option value="'+d.id+'"'+a+">"+d.name+"</option>";k.append(a);a=!1}$("#item_pack-throbber").remove();var D=m/B;A='<span id="TotalQuantity"> / '+
D.toFixed(2)+" "+C+" ("+i18n.in_inv+")</span>";l.after(A);if(1<u){var G;k.on("change",function(){G=parseInt(k.val());for(c=0;c<u;c++)if(d=t[c],d.id==G){B=d.quantity;C=d.name;D=m/B;$("#TotalQuantity").html(D.toFixed(2)+" "+C+" ("+i18n.in_inv+")");break}})}})}else{var b,v=!0;f=F[z];var w=f.packs,x=w.length,n=f.req_items,g=n[0],H=g.inv_quantity;for(b=0;b<x;b++){var e=w[b];if(1==e.quantity){q=e.name;break}}for(b=0;b<x;b++){e=w[b];if(v){var p=e.quantity;var E=e.name;f=" selected"}else f="";f=1!==e.quantity?
'<option value="'+e.id+'"'+f+">"+e.name+" ("+e.quantity+" x "+q+")</option>":'<option value="'+e.id+'"'+f+">"+e.name+"</option>";k.append(f);v=!1}var h=H/p;q='<span id="TotalQuantity"> / '+h.toFixed(2)+" "+E+" ("+i18n.in_inv+")</span>";l.after(q);var I=function(){if(1==n.length){var a=g.req_quantity/p;a<=h?l.val(a):l.val(h);$("#inv_track_item_req_item_id").val(g.req_item_id)}else{y.show();var c,m=$("#inv_track_item_req_item_id");m.html("");for(b=0;b<n.length;b++)g=n[b],m.append(new Option(g.req_ref,
g.req_item_id)),v&&(a=g.req_quantity/p,a<=h?l.val(a):l.val(h)),v=!1;m.on("change",function(){c=parseInt(m.val());for(b=0;b<n.length;b++)if(g=n[b],g.req_item_id==c){a=g.req_quantity/p;a<=h?l.val(a):l.val(h);break}})}};I();if(1<x){var J;k.on("change",function(){J=parseInt(k.val());for(b=0;b<x;b++)if(e=w[b],e.id==J){p=e.quantity;E=e.name;h=H/p;$("#TotalQuantity").html(h.toFixed(2)+" "+E+" ("+i18n.in_inv+")");I();break}})}}}};r.change(K);r.val()&&K()}});
