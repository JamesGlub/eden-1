$(document).ready(function(){var x=$("#inv_track_item_item_id");if(x.length){var I,E=S3.supply.packs||{},u,a,l=S3.supply.binnedQuantity||0,B,O=$("#rdy-defaultbin-0"),g,F,y=$("#sub-defaultrecv_bin"),m=x.val(),z=$("#inv_track_item_item_pack_id"),C,h,A=$("#sub_defaultrecv_bin_defaultrecv_bin_i_quantity_edit_none"),P=/(\d)(?=(\d{3})+(?!\d))/g,n=$("#sub_defaultrecv_bin_defaultrecv_bin_i_quantity_edit_0"),p,J,q,D,G,K,d,e=$("#inv_track_item_quantity"),r=$("#inv_track_item_recv_quantity"),c,Q=S3.supply.req_data||
{},t,v=$("#inv_track_item_req_item_id"),H=$("#inv_track_item_req_item_id__row"),b,L;H.length&&H.hide();var M=function(){F=!0;D=E[m];G={};K=D.length;z.html("");for(i=0;i<K;i++)q=D[i],G[q.i]=q.q,F?(C=q.i,p=d=q.q,selected=" selected"):selected="",F=!1,J='<option value="'+q.i+'"'+selected+">"+q.n+"</option>",z.append(J)};x.on("change.s3",function(w,k){m=x.val();(D=E[m])?M():(I=S3.Ap.concat("/supply/item_packs.json/"+m),$.ajaxS3({url:I,dataType:"json",success:function(R){E[m]=R;M()}}));if(!k){e.val("");
r.val("");if(t=Q[m])if(1==t.length){var f=t[0];b=f.q/d;e.val(b);v.val(f.i)}else{H.show();var N;v.html("");k=!0;for(i=0;i<t.length;i++)f=t[i],v.append(new Option(f.r,f.u)),k&&(b=f.q/d,e.val(void 0)),k=!1;v.on("change",function(){N=parseInt(v.val());for(i=0;i<t.length;i++)if(f=t[i],f.i==N){b=f.q/d;e.val(b);break}})}else v.val(""),b=0;c=0;y.inlinecomponent("removeRows");l=0}});m&&(startingItemPackID=C=z.val(),x.trigger("change.s3",!0));z.on("change.s3",function(){C=z.val();d=G[C];if(b=e.val())b=parseFloat(b),
b=b*p/d,e.val(totalQuantity),(c=r.val())?(c=parseFloat(c),c=c*p/d,r.val(c)):c=b;a=A.val();a=a*p/d;A.val(a);a=n.val();a=a*p/d;n.val(a);L=function(w){a=w.quantity.value;a=a*p/d;w.quantity.value=a;w.quantity.text=a.toString().replace(P,"$1,")};y.inlinecomponent("updateRows",L);p=d});y.on("click.s3",".inline-edt",function(){if(a=n.val())a=parseFloat(a),l-=a*d});O.click(function(){if(a=n.val())a=parseFloat(a),l+=a*d});e.change(function(){(b=e.val())?(b=parseFloat(b),(c=r.val())?c>b&&(h="Quantity Sent increased to Quantity Received",
g=$('<div class="alert alert-warning" style="padding-left:36px;">'+h+'<button type="button" class="close" data-dismiss="alert">\u00d7</button></div>'),b=c,e.val(c).parent().append(g).undelegate(".s3").delegate(".alert","click.s3",function(){$(this).fadeOut("slow").remove();return!1})):c=b):b=c=0});r.change(function(){(c=r.val())?(c=parseFloat(c),c>b&&(h="Quantity Received reduced to Quantity Sent",g=$('<div class="alert alert-warning" style="padding-left:36px;">'+h+'<button type="button" class="close" data-dismiss="alert">\u00d7</button></div>'),
c=b,r.val(b).parent().append(g).undelegate(".s3").delegate(".alert","click.s3",function(){$(this).fadeOut("slow").remove();return!1}))):c=b});A.change(function(){if(a=A.val())a=parseFloat(a),B=1*l/d,u=c-B,a>u&&(h="Bin Quantity reduced to Quantity remaining to be Received",g=$('<div class="alert alert-warning" style="padding-left:36px;">'+h+'<button type="button" class="close" data-dismiss="alert">\u00d7</button></div>'),A.val(u).parent().append(g).undelegate(".s3").delegate(".alert","click.s3",function(){$(this).fadeOut("slow").remove();
return!1}))});n.change(function(){if(a=n.val())a=parseFloat(a),B=1*l/d,u=c-B,a>u&&(h="Bin Quantity reduced to Quantity remaining to be Received",g=$('<div id="sub_defaultrecv_bin_defaultrecv_bin_i_quantity_edit_0-warning" class="alert alert-warning" style="padding-left:36px;">'+h+'<button type="button" class="close" data-dismiss="alert">\u00d7</button></div>'),n.val(u).parent().append(g).undelegate(".s3").delegate(".alert","click.s3",function(){$(this).fadeOut("slow").remove();return!1}))});y.on("rowAdded",
function(w,k){if(a=k.quantity.value)a=parseFloat(a),l+=a*d});y.on("rowRemoved",function(w,k){if(a=k.quantity.value)a=parseFloat(a),l-=a*d})}});
