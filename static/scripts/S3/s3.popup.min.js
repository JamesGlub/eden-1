var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.checkStringArgs=function(a,c,b){if(null==a)throw new TypeError("The 'this' value for String.prototype."+b+" must not be null or undefined");if(c instanceof RegExp)throw new TypeError("First argument to String.prototype."+b+" must not be a regular expression");return a+""};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;
$jscomp.FORCE_POLYFILL_PROMISE=!1;$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,c,b){if(a==Array.prototype||a==Object.prototype)return a;a[c]=b.value;return a};
$jscomp.getGlobal=function(a){a=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var c=0;c<a.length;++c){var b=a[c];if(b&&b.Math==Math)return b}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};
$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(a,c){var b=$jscomp.propertyToPolyfillSymbol[c];if(null==b)return a[c];b=a[b];return void 0!==b?b:a[c]};$jscomp.polyfill=function(a,c,b,e){c&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(a,c,b,e):$jscomp.polyfillUnisolated(a,c,b,e))};
$jscomp.polyfillUnisolated=function(a,c,b,e){b=$jscomp.global;a=a.split(".");for(e=0;e<a.length-1;e++){var d=a[e];if(!(d in b))return;b=b[d]}a=a[a.length-1];e=b[a];c=c(e);c!=e&&null!=c&&$jscomp.defineProperty(b,a,{configurable:!0,writable:!0,value:c})};
$jscomp.polyfillIsolated=function(a,c,b,e){var d=a.split(".");a=1===d.length;e=d[0];e=!a&&e in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var f=0;f<d.length-1;f++){var g=d[f];if(!(g in e))return;e=e[g]}d=d[d.length-1];b=$jscomp.IS_SYMBOL_NATIVE&&"es6"===b?e[d]:null;c=c(b);null!=c&&(a?$jscomp.defineProperty($jscomp.polyfills,d,{configurable:!0,writable:!0,value:c}):c!==b&&(void 0===$jscomp.propertyToPolyfillSymbol[d]&&(b=1E9*Math.random()>>>0,$jscomp.propertyToPolyfillSymbol[d]=$jscomp.IS_SYMBOL_NATIVE?
$jscomp.global.Symbol(d):$jscomp.POLYFILL_PREFIX+b+"$"+d),$jscomp.defineProperty(e,$jscomp.propertyToPolyfillSymbol[d],{configurable:!0,writable:!0,value:c})))};$jscomp.polyfill("String.prototype.startsWith",function(a){return a?a:function(c,b){var e=$jscomp.checkStringArgs(this,c,"startsWith");c+="";var d=e.length,f=c.length;b=Math.max(0,Math.min(b|0,e.length));for(var g=0;g<f&&b<d;)if(e[b++]!=c[g++])return!1;return g>=f}},"es6","es3");
$jscomp.polyfill("String.prototype.endsWith",function(a){return a?a:function(c,b){var e=$jscomp.checkStringArgs(this,c,"endsWith");c+="";void 0===b&&(b=e.length);b=Math.max(0,Math.min(b|0,e.length));for(var d=c.length;0<d&&0<b;)if(e[--b]!=c[--d])return!1;return 0>=d}},"es6","es3");
function s3_popup_refresh_caller(a){var c=getQueryParams(document.location.search),b=window.parent,e,d,f,g=c.refresh;if(void 0!==g){isNaN(parseInt(g))||b.location.reload(!0);var h=b.$("#"+g);if(h.hasClass("dl")){var l=c.record;void 0!==l?h.datalist("ajaxReloadItem",l):h.datalist("ajaxReload")}else if(h.hasClass("s3-organizer"))try{h.organizer("reload")}catch(k){}else if(h.children("div").hasClass("s3-hierarchy-tree"))try{h.hierarchicalcrud("reload")}catch(k){}else try{h.dataTable().fnReloadAjax()}catch(k){}var x=
b.S3.gis.maps;if("undefined"!=typeof x)for(f in x){var p=x[f];l=g.replace(/-/g,"_");a=p.layers;c=0;for(d=a.length;c<d;c++){var m=a[c];if(m.s3_layer_id==l){var B=m.strategies;m=0;for(e=B.length;m<e;m++){var C=B[m];if("OpenLayers.Strategy.Refresh"==C.CLASS_NAME){C.refresh();break}}break}}}b.$(".filter-form").trigger("dataChanged",g);b.S3.popup_remove()}else if(l=c.refresh_layer,"undefined"!=typeof l){if(x=b.S3.gis.maps,"undefined"!=typeof x)for(f in"undefined"!=l&&(l=parseInt(l)),g=b.i18n.gis_draft_layer,
x)for(p=x[f],a=p.layers,c=0,d=a.length;c<d;c++)if(m=a[c],m.s3_layer_id==l)for(B=m.strategies,m=0,e=B.length;m<e;m++){if(C=B[m],"OpenLayers.Strategy.Refresh"==C.CLASS_NAME){C.refresh();break}}else if(m.name==g){for(;p.popups.length;)p.removePopup(p.popups[0]);e=m.features;for(m=e.length-1;0<=m;m--)e[m].destroy()}}else if(f=c.node)l=b.$("#"+c.hierarchy),f=b.$("#"+f),l&&f&&l.hierarchicalcrud("refreshNode",f),b.S3.popup_remove();else if(f=c.agent,"undefined"!=typeof f)l="undefined"!=typeof a?[a]:[],b.$("#"+
f).trigger("configSaved",l);else if("undefined"!=typeof c.level)b.S3.popup_remove();else{var n=c.caller;if(void 0===n)s3_debug("Neither calling element nor refresh-target specified in popup URL!"),b.S3.popup_remove();else if(s3_debug("caller",n),f=c.person_id,"undefined"!=typeof f)b.$("#"+n).val(f).change(),b.S3.popup_remove();else{a=c.child;g=c.prefix;f=c.optionsVar;l=c.optionsValue;var v=c.parent;d=""+b.location;p=new RegExp(".*\\"+S3.Ap+"\\/");if("undefined"===typeof a){a=(""+window.location).replace(p,
"");a=a.split("?")[0].split("/");var z=a[1].split(".")[0]+"_id"}else z=a;s3_debug("childResource",z);a=d.replace(p,"");"undefined"===typeof v?(c=n.replace("_"+z,""),s3_debug("parentField",c),d=c.replace(/_.*/,""),c=c.replace(d+"_",""),a=a.split("?")[0].split("/"),d=null,g||(g=a[0]),p=a[1],2<a.length&&(null!==a[2].match(/\d*/)?3<a.length&&(d=a[3]):d=a[2]),null!==d&&c!=p&&c==d&&(c=p+"/"+d)):(c=v,g||(a=d.replace(p,""),a=a.split("?")[0].split("/"),g=a[0]));s3_debug("parentResource",c);s3_debug("lookupPrefix",
g);s3_debug("optionsVar",f);s3_debug("optionsValue",l);g=S3.Ap.concat("/"+g+"/"+c+"/options.s3json?field="+z);"undefined"!==typeof f&&"undefined"!==typeof l&&(g+="&"+f+"="+l);h=b.$("#"+n);var D=h.hasClass("checkboxes-widget-s3"),K="sub_"==n.substring(0,4),H=b.$("#dummy_"+n),I=void 0!==H.val(),E,G=h.hasClass("s3-hierarchy-input");s3_debug("hasDummy",I);if(D){s3_debug("checkboxes",D);var L=b.$("#"+n+" tbody tr:first").children().length;var t=[]}else{var M=b.$("#"+n+" >option");(E="select"==h.prop("tagName").toLowerCase())?
(s3_debug("isDropdown",E),t=[]):G?(s3_debug("isHierarchyWidget",G),g+="&hierarchy=1&only_last=1"):g+="&only_last=1"}var A=1,J="";$.getJSONS3(g,function(k){var w=0;if((k=k.option)&&k.length)if(k.forEach(function(y){var q=y["@value"],r=y.$;void 0===r&&(r="");E?t.push(["<option value='",q,"'>",r,"</option>"].join("")):D?(y="id_"+z+"-"+w,t.push(["<td><input id='",y,"' name='",z,"' value='",q,"' type='checkbox'><label for='",y,"'>",r,"</label></td>"].join("")),w++):G&&(v=y["@parent"],h.parent().hierarchicalopts("addNode",
v,q,r,!0),n.startsWith("sub_")&&(n.endsWith("_none")?(b.$("#"+n.replace("_none","_0")).parent().hierarchicalopts("addNode",v,q,r,!1),b.$("#"+n.replace("_none","_default")).parent().hierarchicalopts("addNode",v,q,r,!1)):n.endsWith("_0")&&(b.$("#"+n.replace("_0","_none")).parent().hierarchicalopts("addNode",v,q,r,!1),b.$("#"+n.replace("_0","_default")).parent().hierarchicalopts("addNode",v,q,r,!1))));q=+q;!isNaN(q)&&q>A&&(A=q,J=r)}),I&&(H.val(J),h.val(A).change()),E){if(K){var u=["_0","_none","_default"],
N=n.split("_").slice(0,-1).join("_");for(k=0;k<u.length;k++){var O=u[k];b.$("#"+N+O).empty().append(t.join(""))}}else M.remove(),h.append(t.join("")).val(A).change();h.val(A).change();h.prop("disabled",!1);if(h.hasClass("multiselect-widget")&&h.multiselect("instance"))try{h.multiselect("refresh")}catch(y){}}else{if(D){var F=[];b.$("#"+n+" input").each(function(){$(this).prop("checked")&&F.push($(this).val())});u=[];for(k=w=0;k<t.length;k++)0===w?(u.push("<tr>"),u.push(t[k]),w++):w==L-1?(u.push(t[k]),
u.push("</tr>"),w=0):(u.push(t[k]),w++);h.html(u.join(""));F.push(A);for(k=0;k<F.length;k++)b.$("#"+n+' input[value="'+F[k]+'"]').prop("checked",!0)}}else s3_debug("No options available to refresh parent field");b.S3.popup_remove()})}}}function getQueryParams(a){a=a.substring(1);var c={};if(a){a=a.split("&");for(var b,e=0,d=a.length;e<d;e++)b=a[e].split("="),c[decodeURIComponent(b[0])]=decodeURIComponent(b[1])}return c};
